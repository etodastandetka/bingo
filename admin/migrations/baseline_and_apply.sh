#!/bin/bash

# –°–∫—Ä–∏–ø—Ç –¥–ª—è baseline —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –º–∏–≥—Ä–∞—Ü–∏–π –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –Ω–æ–≤–æ–π
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: ./baseline_and_apply.sh

echo "üîß Baseline —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –º–∏–≥—Ä–∞—Ü–∏–π..."

cd /var/www/bingo_bot/admin

# –ü–æ–º–µ—á–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –º–∏–≥—Ä–∞—Ü–∏—é –∫–∞–∫ –ø—Ä–∏–º–µ–Ω–µ–Ω–Ω—É—é (baseline)
# –≠—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –æ–¥–∏–Ω —Ä–∞–∑ –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –±–∞–∑—ã
echo "–ü–æ–º–µ—á–∞–µ–º –º–∏–≥—Ä–∞—Ü–∏—é 20250101120000_add_bot_type_to_request –∫–∞–∫ –ø—Ä–∏–º–µ–Ω–µ–Ω–Ω—É—é..."
npx prisma migrate resolve --applied 20250101120000_add_bot_type_to_request

if [ $? -eq 0 ]; then
    echo "‚úÖ Baseline –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ!"
    
    # –¢–µ–ø–µ—Ä—å –ø—Ä–∏–º–µ–Ω—è–µ–º –Ω–æ–≤—É—é –º–∏–≥—Ä–∞—Ü–∏—é
    echo "üì¶ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –Ω–æ–≤–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏ casino_limits..."
    npx prisma migrate deploy
    
    if [ $? -eq 0 ]; then
        echo "‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∞!"
    else
        echo "‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–∏ –º–∏–≥—Ä–∞—Ü–∏–∏"
        exit 1
    fi
else
    echo "‚ö†Ô∏è  –ú–∏–≥—Ä–∞—Ü–∏—è —É–∂–µ –ø–æ–º–µ—á–µ–Ω–∞ –∏–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞, –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º..."
    # –ü—Ä–æ–±—É–µ–º –ø—Ä–∏–º–µ–Ω–∏—Ç—å –Ω–æ–≤—É—é –º–∏–≥—Ä–∞—Ü–∏—é
    npx prisma migrate deploy
fi

